<div class="col-lg-10 col-md-9 ucbg-white">
    <div class="uc-inpli">
        <h2 class="uc-r-tit">推广内容</h2>
        <form id="addPromotion" name="addPromotion" method="post" role="form" action="/weekly/editPromotion">
            <input type="hidden" id="promotion_input" name="promotionInfo" value="">
            <input type="hidden" id="weeklyId" name="weeklyId" value="<%= weekly.id %>">
        </form>
        <form class="form-horizontal" id="form1" name="form1" role="form">
            <%if(info){%>
            <div class="form-group">
                <label class="col-sm-2 control-label">标题 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="<%= info.title%>" placeholder="标题" id="title" type="text" name="title">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">链接 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="<%= info.url%>" placeholder="链接" id="url" type="text" name="url">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">描述 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="<%= info.description%>" placeholder="描述" id="description" type="text" name="description">
                </div>
            </div>
            <%} else {%>
            <div class="form-group">
                <label class="col-sm-2 control-label">标题 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="" placeholder="标题" id="title" type="text" name="title">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">链接 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="" placeholder="链接" id="url" type="text" name="url">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">描述 : </label>
                <div class="col-sm-10">
                    <input class="form-control" value="" placeholder="描述" id="description" type="text" name="description">
                </div>
            </div>
            <%}%>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <hr style="height:1px;border:none;border-top:1px solid #555555;" />
                    <input type="button" value="添加推广" class="btn btn-primary" id="confirm" onclick="editPromotion()">
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    $(function(){
        leftmenu_select(4, 0);
    });

    function editPromotion(){
        var info = {};
        info.weeklyId =  $("#weeklyId").val();
        info.title = $("#title").val();
        info.url = $("#url").val();
        info.description = $("#description").val();
        if (!info.title || !info.url || !info.description) {
            alert("内容填写不完整!");
        }
        else {
            $.ajax({
                type: 'POST',
                url: '/weekly/editPromotion',
                async: false,
                data: JSON.stringify(info),
                dataType: "json",
                contentType: "application/json;charset=utf-8",
                success: function (data) {
                    if(data.err){
                        alert(data.err+', 保存失败');
                    }
                    else{
                        alert("保存数据成功!");
                        location.href="/weekly/edit";
                    }
                }
            });
        }




    }
</script>